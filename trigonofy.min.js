import c from"chroma-js";import U from"chroma-js";function C(t){let n=Object.values(t).filter(r=>isFinite(r)),e=Math.floor(Math.random()*n.length);return n[e]}function g(t,n){t<0&&(t=0),n<0&&(n=0),t>n&&([t,n]=[n,t]);let e=n-t,r=Math.floor(Math.random()*(e+1));return t+r}function S(t,n,e,r,o){let[i,s]=[n/2,0],[u,f]=[n/2,e];if(Math.abs(o)!==90){let a=Math.tan(o*Math.PI/180),m=n/2,l=e/2,[p,M]=[m,a*m];M>l?[p,M]=[l/a,l]:M<-l&&([p,M]=[-l/a,-l]),[u,f]=[Math.round(p+n/2),Math.round(M+e/2)],[i,s]=[n-u,e-f],a<0&&([i,u]=[u,i],[s,f]=[f,s])}let h=r.length,d=t.createLinearGradient(i,s,u,f);return r.forEach((a,m)=>{d.addColorStop(m/(h-1),a)}),d}function x(t,n,e){let r=t.getImageData(n,e,1,1).data;return U.rgb(r[0],r[1],r[2])}function v(t,n){t.moveTo(n[0][0],n[0][1]);for(let e=1;e<n.length;e++)t.lineTo(n[e][0],n[e][1])}var b=class{static random(n){switch(g(1,7)){case 1:return this.chaos(n);case 2:return this.complementary(n);case 3:return this.monochromatic(n);case 4:return this.analogous(n);case 5:return this.triadic(n);case 6:return this.tetradic(n);case 7:default:return this.colorbrewer()}}static chaos(n){let r=[P(n)],o=g(4,10);for(let i=1;i<4;i++)r.push(D(r[i-1]));return c.scale(r).mode("lch").colors(o)}static complementary(n){let e=P(n),[r,o,i]=e.hsl(),s=c.hsl(r-180,o,i),u=g(4,10);return c.scale([e,s]).mode("lch").colors(u)}static monochromatic(n){let e=P(n),[r,o,i]=e.hsl(),s=g(4,10),u=1/(s+1),f=[];for(let h=s;h>=1;h--)f.push(c.hsl(r,o,h*u).hex());return f}static analogous(n){let e=P(n),[r,o,i]=e.hsl(),s=c.hsl(r+30,o,i),u=c.hsl(r+60,o,i),f=g(4,10);return c.scale([e,s,u]).mode("lch").colors(f)}static triadic(n){let e=P(n),[r,o,i]=e.hsl(),s=c.hsl(r+120,o,i),u=c.hsl(r+240,o,i),f=g(4,10);return c.scale([e,s,u]).mode("lch").colors(f)}static tetradic(n){let e=P(n),[r,o,i]=e.hsl(),s=c.hsl(r+90,o,i),u=c.hsl(r+180,o,i),f=c.hsl(r+270,o,i),h=g(4,10);return c.scale([e,s,u,f]).mode("lch").colors(h)}static colorbrewer(n){let e=Object.keys(c.brewer);if(n!=null&&n in e)return c.brewer[n];{let r=Math.floor(Math.random()*e.length);return c.brewer[e[r]]}}static isValid(n){return!Array.isArray(n)||n.length<2?!1:n.every(e=>typeof e=="string"&&c.valid(e))}static luminance(n){return c.average(n,"lch").luminance()}};function P(t){return c.valid(t)?c(t):c.random()}function D(t){if(t==null)return c.random();let n=g(1,3),[e,r,o]=t.hsl();switch(n){case 1:e=g(1,360);case 2:r=Math.random();case 3:default:o=Math.random()}return c.hsl(e,r,o)}import O from"chroma-js";import{Delaunay as W}from"d3-delaunay";var y;(function(e){e[e.Uniform=0]="Uniform",e[e.Grid=1]="Grid"})(y||(y={}));function z(t,n,e){return e==null&&(e={type:C(y)}),e.type===0?I(t,n,e):V(t,n,e)}function I(t,n,e){t<0&&(t=0),n<0&&(n=0);let r=e.cellSize;(r==null||r<=0)&&(r=G(t,n));let o=Math.max(Math.min(t,n)/2,r),i=t+2*o,s=n+2*o,u=Math.ceil(s/r),f=Math.ceil(i/r),h=u*f,d=[];for(let a=0;a<h;a++){let m=Math.round(Math.random()*i-o),l=Math.round(Math.random()*s-o);d.push([m,l])}return d}function V(t,n,e){t<0&&(t=0),n<0&&(n=0);let r=e.variance;r<0?r=0:r>1?r=1:r==null&&(r=Math.random());let o=e.cellSize;(o==null||o<=0)&&(o=G(t,n));let i=Math.max(Math.min(t,n)/2,o),[s,u]=[-i,t+i],[f,h]=[-i,n+i],d=()=>{let m=Math.round(Math.random()),l=Math.round(Math.random()*o*r);return m===1?l:-l},a=[];for(let m=s;m<=u;m+=o)for(let l=f;l<=h;l+=o)a.push([m+d(),l+d()]);return a}function G(t,n){let e=Math.min(t,n),r=Math.min(e,50),o=Math.floor(e/5);return g(r,o)}function j(t,n){R(t,n,!1)}function k(t,n){R(t,n,!0)}function R(t,n,e){b.isValid(n.palette)||(n.palette=b.random());let r=n.gradientAngle;if((typeof r!="number"||!isFinite(r))&&(r=g(0,360)),r<0)for(;r<0;)r+=360;else if(r>360)for(;r>360;)r-=360;let{width:o,height:i,palette:s}={...n},u=S(t,o,i,s,r),f=z(o,i,n.points),h=W.from(f),d;if(e?d=[...h.voronoi([0,0,o,i]).cellPolygons()]:d=[...h.trianglePolygons()],d=d.filter(a=>a.some(m=>{let[l,p]=[m[0],m[1]];return l>=0&&l<=o&&p>=0&&p<=i})),t.lineWidth=n.lineWidth||0,t.fillStyle=u,t.strokeStyle=u,n.lineOnly!==!0){if(t.lineWidth>0){let a=b.luminance(s)>=.5?p=>O(p).darken().hex():p=>O(p).brighten().hex(),m=s.map(a),l=S(t,o,i,m,r);t.strokeStyle=l}t.fillRect(0,0,o,i),d.forEach(a=>{let m=(a[0][0]+a[1][0]+a[2][0])/3;m<=0?m=1:m>=o&&(m=o-1);let l=(a[0][1]+a[1][1]+a[2][1])/3;l<=0?l=1:l>=i&&(l=i-1),t.beginPath(),t.fillStyle=x(t,m,l).hex(),v(t,a),t.fill()})}t.lineWidth>0&&(t.beginPath(),d.forEach(a=>v(t,a)),t.stroke())}export{b as Palette,j as Triangle,k as Voronoi};
